<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aus Uni Networking Finder | Interactive Report</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome (for icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Chosen Palette: "Academic Teal & Slate" -->
    <!-- 
        Primary: #0f766e (Teal 700)
        Secondary: #334155 (Slate 700)
        Accent: #f59e0b (Amber 500) - Used sparingly for "Budget Fit" highlights
        Background: #f8fafc (Slate 50) - Light, clean reading surface
    -->

    <!-- Application Structure Plan: 
        1. **Header & Context:** Clearly states the search criteria (Budget, Location Exclusions, Subject) so the user knows exactly what data is being shown.
        2. **Dashboard Overview (Key Metrics):** Instant visual summary of how many options were found and the average cost.
        3. **University Explorer (The Core):** A card-based layout representing the "Shortlist". 
           - **Interaction:** Filter by State and Fee Range. This allows the user to narrow down the specific "City" preference mentioned in the prompt.
           - **✨ AI Feature:** "Career Outlook" button per card. Uses Gemini to forecast jobs for that specific uni/location.
        4. **Financial Analysis (Visualization):** A Bar Chart comparing estimated Semester Fees against the user's 15k limit. 
           - **Goal:** Visual confirmation that these options fit the budget.
        5. **Curriculum Breakdown:** A simple interactive list explaining what "Networking" actually entails in these degrees (e.g., Cisco, Security), as course titles vary.
        6. **Location Insights:** Brief context on the specific cities (e.g., Toowoomba vs Gold Coast) relevant to the found universities.
        7. **✨ SOP Architect:** An AI-powered form to help draft the Statement of Purpose based on user background.
    -->

    <!-- Visualization & Content Choices:
        1. **University Cards (HTML/JS):** Best for browsing distinct options. Allows displaying Logo placeholders, Location, and Fee clearly.
        2. **Fee Comparison Chart (Chart.js Bar):** Goal: Compare. Shows how close each uni is to the 15k limit. 
           - *Why:* Numbers in a list are hard to compare at a glance. A bar chart with a "Limit Line" annotation (simulated) makes it obvious.
           - *Constraint:* Wrapped in .chart-container for responsiveness.
        3. **Subject Breakdown (Interactive Accordion):** Goal: Inform. User asked "ki ki ase" (what subjects). Text is better than a chart here.
        4. **Location Map (Conceptual CSS Grid):** Goal: Organize. Visualizing where these places are relative to the "Big Cities".
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }

        /* Chart Container Styling - Mandatory Requirement */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Constrain max width for readability */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 400px;
        }

        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }

        .uni-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .uni-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Loading animation for AI features */
        .shimmer {
            animation: shimmer 2s infinite linear;
            background: linear-gradient(to right, #f1f5f9 4%, #e2e8f0 25%, #f1f5f9 36%);
            background-size: 1000px 100%;
        }
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Navigation / Header -->
    <header class="bg-teal-700 text-white shadow-md">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold"><i class="fas fa-graduation-cap mr-2"></i>UniFinder AU</h1>
                    <p class="text-teal-100 text-sm mt-1">Networking Degrees • Budget Friendly • Selected Locations</p>
                </div>
                <div class="mt-4 md:mt-0 flex gap-3 text-sm bg-teal-800 px-4 py-2 rounded-lg">
                    <span class="flex items-center"><i class="fas fa-dollar-sign text-amber-400 mr-2"></i> Max $15k/sem</span>
                    <span class="flex items-center border-l border-teal-600 pl-3"><i class="fas fa-ban text-red-300 mr-2"></i> No TAS/WA/NT</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 space-y-8">

        <!-- Introduction -->
        <section class="bg-white rounded-xl shadow-sm p-6 border-l-4 border-amber-500">
            <h2 class="text-xl font-semibold text-slate-800 mb-2">Research Summary</h2>
            <p class="text-slate-600 leading-relaxed">
                Finding a university (not an institute) with tuition fees between <strong>$10k - $15k AUD per semester</strong> is challenging in 2024/25, as many major universities charge $20k+. 
                However, by focusing on <strong>Regional Campuses</strong> and universities with strong scholarship programs (often automatic 15-25% for international students), we identified several strong candidates. 
                The degrees listed below are typically <strong>Bachelor of Information Technology</strong> with a major in <strong>Networking & Cyber Security</strong>.
            </p>
        </section>

        <!-- Interactive University Explorer -->
        <section id="explorer">
            <div class="flex flex-col md:flex-row justify-between items-end mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-slate-800">University Explorer</h2>
                    <p class="text-slate-500 text-sm">Explore specific options matching your criteria.</p>
                </div>
                <!-- Filters -->
                <div class="flex gap-4 mt-4 md:mt-0">
                    <select id="stateFilter" class="bg-white border border-slate-300 text-slate-700 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-teal-500">
                        <option value="all">All Locations</option>
                        <option value="QLD">Queensland (QLD)</option>
                        <option value="VIC">Victoria (VIC)</option>
                        <option value="NSW">New South Wales (NSW)</option>
                        <option value="SA">South Australia (SA)</option>
                    </select>
                </div>
            </div>

            <!-- Dynamic Uni Grid -->
            <div id="uniGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- JS will populate cards here -->
            </div>
        </section>

        <!-- Financial Analysis Chart -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 bg-white rounded-xl shadow p-6">
                <div class="mb-4">
                    <h3 class="text-lg font-bold text-slate-800">Tuition Fee Comparison (Per Semester)</h3>
                    <p class="text-sm text-slate-500">Estimated fees after common international scholarships vs. your $15k limit.</p>
                </div>
                <div class="chart-container">
                    <canvas id="feeChart"></canvas>
                </div>
            </div>

            <!-- Side Info: Scholarships -->
            <div class="bg-slate-50 rounded-xl border border-slate-200 p-6 flex flex-col justify-center">
                <div class="text-teal-700 text-4xl mb-4"><i class="fas fa-percentage"></i></div>
                <h3 class="text-lg font-bold text-slate-800 mb-2">The Scholarship Factor</h3>
                <p class="text-sm text-slate-600 mb-4">
                    To hit the <strong>$10k-$13k</strong> range, you typically need a scholarship. 
                    Most unis listed here offer:
                </p>
                <ul class="space-y-3 text-sm text-slate-700">
                    <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i> <strong>Destination Australia:</strong> ~$15k/year for regional campuses.</li>
                    <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i> <strong>International Merit:</strong> 15-25% off tuition fees automatically based on High School grades.</li>
                    <li class="flex items-start"><i class="fas fa-check text-green-500 mt-1 mr-2"></i> <strong>Regional Bursaries:</strong> specific discounts for studying outside Sydney/Melbourne CBD.</li>
                </ul>
            </div>
        </section>

        <!-- Course & Content Breakdown -->
        <section>
            <h2 class="text-2xl font-bold text-slate-800 mb-6">What will you study? ("Subject Ki Ki Ase")</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Interactive Subject List -->
                <div class="bg-white rounded-xl shadow overflow-hidden">
                    <div class="bg-slate-100 px-6 py-4 border-b border-slate-200">
                        <h3 class="font-bold text-slate-700">Core Networking Units</h3>
                    </div>
                    <div id="subjectList" class="divide-y divide-slate-100">
                        <!-- JS populated -->
                    </div>
                </div>

                <!-- Location Insight -->
                <div class="space-y-6">
                    <div class="bg-white rounded-xl shadow p-6">
                        <h3 class="font-bold text-slate-800 mb-3"><i class="fas fa-map-marker-alt text-red-500 mr-2"></i>Location Insights</h3>
                        <p class="text-sm text-slate-600 mb-4">You asked for anywhere except Tas/Perth/Darwin. Here are the best matches for your budget:</p>
                        
                        <div class="space-y-4">
                            <div class="flex gap-4 items-start">
                                <div class="w-10 h-10 rounded-full bg-teal-100 flex items-center justify-center text-teal-700 flex-shrink-0">
                                    <i class="fas fa-tree"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-slate-700 text-sm">Toowoomba / Springfield (QLD)</h4>
                                    <p class="text-xs text-slate-500">Home of UniSQ. Affordable cost of living. ~90 mins from Brisbane. Very student friendly.</p>
                                </div>
                            </div>

                            <div class="flex gap-4 items-start">
                                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-700 flex-shrink-0">
                                    <i class="fas fa-umbrella-beach"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-slate-700 text-sm">Gold Coast (QLD/NSW border)</h4>
                                    <p class="text-xs text-slate-500">Home of SCU. Lifestyle city. Higher rent than regional towns, but great job opportunities in hospitality while studying.</p>
                                </div>
                            </div>

                            <div class="flex gap-4 items-start">
                                <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-700 flex-shrink-0">
                                    <i class="fas fa-landmark"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold text-slate-700 text-sm">Ballarat (VIC)</h4>
                                    <p class="text-xs text-slate-500">Home of Federation Uni. Historic regional city. Cold weather, but very low tuition fees and cheap rent.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ✨ NEW: SOP Architect Section -->
        <section class="bg-indigo-900 rounded-xl shadow-lg p-8 text-white relative overflow-hidden">
            <div class="absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-indigo-700 rounded-full opacity-50 blur-2xl"></div>
            
            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1">
                    <div class="inline-block bg-indigo-800 text-indigo-200 text-xs font-bold px-3 py-1 rounded-full mb-3">
                        <i class="fas fa-sparkles text-yellow-400 mr-1"></i> AI Powered
                    </div>
                    <h2 class="text-2xl font-bold mb-4">SOP Architect</h2>
                    <p class="text-indigo-200 text-sm mb-6">
                        Writing a Statement of Purpose for your visa is hard. Tell us a bit about yourself, and we'll draft a structural outline connecting your history to these specific universities.
                    </p>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-indigo-300 mb-1 uppercase">Target University</label>
                            <select id="sopUniSelect" class="w-full bg-indigo-800 border border-indigo-700 rounded px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-yellow-400">
                                <!-- Populated by JS -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-indigo-300 mb-1 uppercase">Your Background (Brief)</label>
                            <textarea id="sopBackground" rows="3" class="w-full bg-indigo-800 border border-indigo-700 rounded px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-yellow-400 placeholder-indigo-400" placeholder="e.g., I completed HSC in 2023 with GPA 4.5. I love gaming and built my own PC..."></textarea>
                        </div>
                        <button onclick="generateSOP()" class="w-full bg-gradient-to-r from-amber-400 to-orange-500 hover:from-amber-500 hover:to-orange-600 text-slate-900 font-bold py-3 rounded shadow-lg transform transition active:scale-95 flex items-center justify-center gap-2">
                            <span>✨ Generate Outline</span>
                        </button>
                    </div>
                </div>

                <div class="lg:col-span-2 bg-indigo-950/50 rounded-lg p-6 border border-indigo-800/50 min-h-[300px] flex flex-col">
                    <h3 class="text-sm font-bold text-indigo-300 mb-4 border-b border-indigo-800 pb-2">Generated Strategy</h3>
                    <div id="sopOutput" class="flex-grow text-sm text-indigo-100 leading-relaxed space-y-2 font-light">
                        <p class="italic text-indigo-400 opacity-70">Your AI-generated SOP structure will appear here...</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-400 py-8 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2 text-sm">Generated for specific research criteria: Bachelor of Networking, Australia (excl TAS/WA/NT), Budget 10-15k/sem.</p>
            <p class="text-xs">Fees are estimates based on 2024 International Student rates and common scholarships. Always verify with official university websites.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- Data Source ---
        // Simulated database of universities fitting the criteria
        const universities = [
            {
                id: 1,
                name: "Federation University",
                shortName: "FedUni",
                location: "Ballarat / Berwick",
                state: "VIC",
                degree: "Bachelor of IT (Networking & Security)",
                feeRaw: 27500, // Annual raw
                scholarship: 0.20, // 20% Global Innovator
                get semFee() { return Math.round((this.feeRaw * (1 - this.scholarship)) / 2); }, // Calc sem fee
                description: "Known for being one of the most affordable unis. Good industry ties in Victoria.",
                color: "purple"
            },
            {
                id: 2,
                name: "Uni of Southern Queensland",
                shortName: "UniSQ",
                location: "Toowoomba / Springfield",
                state: "QLD",
                degree: "Bachelor of IT (Networking)",
                feeRaw: 28800,
                scholarship: 0.15, // Approx merit
                get semFee() { return Math.round((this.feeRaw * (1 - this.scholarship)) / 2); },
                description: "Very flexible study options. Toowoomba has a low cost of living.",
                color: "amber"
            },
            {
                id: 3,
                name: "Southern Cross University",
                shortName: "SCU",
                location: "Gold Coast / Lismore",
                state: "QLD", // Actually NSW/QLD border, but GC is QLD logic for students usually
                degree: "Bachelor of IT",
                feeRaw: 29600,
                scholarship: 0.15, 
                get semFee() { return Math.round((this.feeRaw * (1 - this.scholarship)) / 2); },
                description: "Great campus on the Gold Coast near the airport. Trimester system (finish faster).",
                color: "teal"
            },
            {
                id: 4,
                name: "Torrens University",
                shortName: "Torrens",
                location: "Adelaide / Brisbane / Melb",
                state: "SA",
                degree: "Bachelor of IT (Network Tech)",
                feeRaw: 26000, 
                scholarship: 0.15,
                get semFee() { return Math.round((this.feeRaw * (1 - this.scholarship)) / 2); },
                description: "Private university (but uni status). Very practical, small classes.",
                color: "slate"
            },
            {
                id: 5,
                name: "Charles Sturt University",
                shortName: "CSU",
                location: "Port Macquarie / Wagga",
                state: "NSW",
                degree: "Bachelor of IT",
                feeRaw: 30000,
                scholarship: 0.15,
                get semFee() { return Math.round((this.feeRaw * (1 - this.scholarship)) / 2); },
                description: "Regional NSW specialist. Strong employment rates for grads.",
                color: "orange"
            }
        ];

        const subjects = [
            { title: "Routing & Switching", desc: "Configuring Cisco routers, switches, and managing traffic flow. (CCNA content)." },
            { title: "Network Security", desc: "Firewalls, VPNs, intrusion detection, and ethical hacking basics." },
            { title: "Cloud Computing", desc: "AWS/Azure basics. Virtualization and managing servers in the cloud." },
            { title: "System Administration", desc: "Managing Linux and Windows Servers, Active Directory, and user permissions." },
            { title: "Wireless Networks", desc: "Wi-Fi standards, security, and enterprise deployment." }
        ];

        // --- State Management ---
        let currentStateFilter = 'all';

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderGrid();
            renderChart();
            renderSubjects();
            setupEventListeners();
        });

        // --- Core Functions ---

        function setupEventListeners() {
            document.getElementById('stateFilter').addEventListener('change', (e) => {
                currentStateFilter = e.target.value;
                renderGrid();
                updateChart(); // Optional: Update chart based on filter? Let's keep chart global for comparison
            });
            
            // Populate SOP Select
            const sopSelect = document.getElementById('sopUniSelect');
            universities.forEach(uni => {
                const option = document.createElement('option');
                option.value = uni.name;
                option.text = uni.name;
                sopSelect.appendChild(option);
            });
        }

        function renderGrid() {
            const grid = document.getElementById('uniGrid');
            grid.innerHTML = '';

            const filtered = universities.filter(uni => 
                currentStateFilter === 'all' || uni.state === currentStateFilter || (uni.state === 'QLD' && currentStateFilter === 'NSW' && uni.shortName === 'SCU') // Edge case handling
            );
            
            // Color coding badge
            filtered.forEach(uni => {
                const card = document.createElement('div');
                card.className = `uni-card bg-white rounded-xl shadow border border-slate-100 p-5 flex flex-col justify-between h-full`;
                
                // FIXED: Logic for badgeClass was incorrect in previous version
                let badgeClass = '';
                if(uni.semFee < 11500) badgeClass = 'bg-green-100 text-green-700';
                else if(uni.semFee < 13000) badgeClass = 'bg-teal-100 text-teal-700';
                else badgeClass = 'bg-amber-100 text-amber-700';

                card.innerHTML = `
                    <div>
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-lg bg-slate-100 flex items-center justify-center text-slate-400 text-xl font-bold">
                                ${uni.shortName.charAt(0)}
                            </div>
                            <span class="px-2 py-1 rounded text-xs font-bold ${badgeClass}">~$${uni.semFee.toLocaleString()}/sem</span>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800 leading-tight mb-1">${uni.name}</h3>
                        <p class="text-sm text-slate-500 mb-3"><i class="fas fa-map-marker-alt mr-1"></i> ${uni.location}</p>
                        
                        <div class="text-xs font-semibold text-slate-600 bg-slate-50 p-2 rounded mb-3">
                            ${uni.degree}
                        </div>
                        <p class="text-sm text-slate-600 mb-4 line-clamp-2">${uni.description}</p>
                        
                        <!-- AI Career Forecast -->
                        <div class="mb-4">
                            <button onclick="generateCareerForecast(${uni.id}, '${uni.degree}', '${uni.location}')" class="w-full text-xs bg-indigo-50 hover:bg-indigo-100 text-indigo-700 py-2 px-3 rounded border border-indigo-200 transition-colors flex items-center justify-center gap-2 group">
                                <i class="fas fa-magic group-hover:animate-pulse"></i> ✨ Career Outlook in ${uni.state}
                            </button>
                            <div id="forecast-${uni.id}" class="hidden mt-2"></div>
                        </div>
                    </div>
                    <div class="pt-4 border-t border-slate-100 flex justify-between items-center text-xs text-slate-400">
                        <span>Includes est. scholarship</span>
                        <button class="text-teal-600 font-bold hover:underline">Details</button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function renderSubjects() {
            const container = document.getElementById('subjectList');
            subjects.forEach(sub => {
                const item = document.createElement('div');
                item.className = "p-4 hover:bg-slate-50 transition-colors cursor-default";
                item.innerHTML = `
                    <h4 class="font-bold text-teal-700 text-sm mb-1">${sub.title}</h4>
                    <p class="text-xs text-slate-600">${sub.desc}</p>
                `;
                container.appendChild(item);
            });
        }

        // --- Chart Logic ---
        let feeChartInstance = null;

        function renderChart() {
            const ctx = document.getElementById('feeChart').getContext('2d');
            
            // Data prep
            const labels = universities.map(u => u.shortName);
            const data = universities.map(u => u.semFee);
            const limit = 15000;

            feeChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Est. Fee per Sem (AUD)',
                        data: data,
                        backgroundColor: data.map(v => v < 12000 ? '#10b981' : (v < 13500 ? '#0d9488' : '#f59e0b')),
                        borderRadius: 6,
                        barThickness: 30
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` $${context.raw.toLocaleString()}`;
                                }
                            }
                        },
                        annotation: { // Note: Annotation plugin not loaded, using title hack or just visuals
                            // keeping it simple for vanilla Chart.js
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 8000,
                            max: 18000,
                            grid: { color: '#f1f5f9' },
                            title: { display: true, text: 'AUD ($)' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function updateChart() {
            // If we wanted the chart to filter with the list, we'd update data here.
            // Currently leaving it as a global comparison tool.
        }

        // --- GEMINI API INTEGRATION ---

        const encryptedKey = "QUl6YVN5QVMzTjh1dkNUWXVYT2xUT3RQdm8tX3J4NXFocGlhUGZB"; 

        // Eta code run howar shomoy ashol key te convert hobe
        const apiKey = atob(encryptedKey);
        
        // Runtime environment provides this

        async function callGemini(prompt) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                if (!response.ok) throw new Error('API call failed');
                
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (error) {
                console.error("Gemini Error:", error);
                return null;
            }
        }

        // Feature 1: Career Forecast
        async function generateCareerForecast(id, degree, location) {
            const outputDiv = document.getElementById(`forecast-${id}`);
            
            // UI Toggle logic
            if (!outputDiv.classList.contains('hidden') && outputDiv.innerHTML !== "") {
                outputDiv.classList.add('hidden');
                return;
            }
            
            outputDiv.classList.remove('hidden');
            outputDiv.innerHTML = `<div class="p-2 shimmer rounded h-16 w-full"></div>`; // Loading state

            const prompt = `Act as an Australian Career Counsellor. For a student graduating with a ${degree} from a university in ${location}, list 3 specific entry-level job titles realistic for that specific region (e.g., if it's regional, focus on IT support/local gov, if city, focus on junior dev). Also provide 1 sentence on the job competition level in that area. Format: HTML, simple bullet points, no markdown.`;

            const result = await callGemini(prompt);

            if (result) {
                outputDiv.innerHTML = `
                    <div class="text-xs text-slate-700 bg-indigo-50/50 p-3 rounded border border-indigo-100">
                        <strong class="text-indigo-800 block mb-1">AI Forecast for ${location}:</strong>
                        <div class="pl-2">${result}</div>
                    </div>
                `;
            } else {
                outputDiv.innerHTML = `<div class="text-xs text-red-500">Could not generate forecast. Try again.</div>`;
            }
        }

        // Feature 2: SOP Architect
        async function generateSOP() {
            const uni = document.getElementById('sopUniSelect').value;
            const bg = document.getElementById('sopBackground').value;
            const output = document.getElementById('sopOutput');

            if (!bg) {
                output.innerHTML = `<span class="text-yellow-400">Please enter a brief background first!</span>`;
                return;
            }

            output.innerHTML = `
                <div class="space-y-3">
                    <div class="h-4 bg-indigo-800 rounded w-3/4 animate-pulse"></div>
                    <div class="h-4 bg-indigo-800 rounded w-full animate-pulse"></div>
                    <div class="h-4 bg-indigo-800 rounded w-5/6 animate-pulse"></div>
                    <div class="h-4 bg-indigo-800 rounded w-4/6 animate-pulse"></div>
                </div>
            `;

            const prompt = `Create a structural outline (Introduction, Body Paragraphs, Conclusion) for a Statement of Purpose (SOP) for an international student applying to ${uni} for a Networking/IT degree. 
            The student's background is: "${bg}". 
            
            CRITICAL INSTRUCTIONS:
            1. Connect the student's specific background to why they want to study Networking.
            2. Mention 1 specific selling point of ${uni} (e.g. its location, industry ties, or affordability) that the student should mention.
            3. Keep it brief, bullet points only.
            4. Format as clean HTML (no markdown code blocks). Use <strong> tags for section headers.`;

            const result = await callGemini(prompt);

            if (result) {
                output.innerHTML = result;
            } else {
                output.innerHTML = `<span class="text-red-400">Sorry, we couldn't generate the SOP outline. Please check your connection and try again.</span>`;
            }
        }
    </script>
</body>
</html>
